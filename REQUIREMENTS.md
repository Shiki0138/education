# 追手門学院中学入試対策漢字学習システム 要件定義書

## 1. システム概要

### 1.1 システム名称
追手門学院中学入試対策漢字学習システム（Kanji Master for Otemon Gakuin）

### 1.2 システムの目的
- 追手門学院中学の入試に特化した漢字学習を支援
- 毎日の継続学習を促進する報酬システムの提供
- 365日間重複なしの問題生成による効率的な学習
- 偏差値40-55+の幅広いレベルに対応した段階的学習

### 1.3 対象ユーザー
- **主要ユーザー**: 小学4-6年生（追手門学院中学受験予定者）
- **副次ユーザー**: 保護者（学習進捗確認・応援メッセージ送信）
- **想定利用者数**: 1世帯あたり1-2名

### 1.4 利用環境
- **対応ブラウザ**: Chrome, Safari, Firefox, Edge（最新版）
- **対応デバイス**: PC, タブレット, スマートフォン
- **必要な通信環境**: インターネット接続（オフライン時はローカルストレージで動作継続）

## 2. 機能要件

### 2.1 学習機能

#### 2.1.1 漢字問題生成機能
**目的**: 毎日異なる漢字問題を自動生成

**詳細仕様**:
- 1日10問の漢字読み問題を生成
- 350個の漢字データベースから選択
- 7日間の重複防止機能
- 日付ベースのシード値による再現性確保

**データ構造**:
```javascript
{
  word: "愛情",          // 漢字単語
  reading: "あいじょう",   // 読み方
  meaning: "人を愛する心", // 意味
  level: 1,              // 難易度（1-4）
  grade: "小4"           // 学年
}
```

#### 2.1.2 難易度レベル管理
**レベル定義**:
- レベル1: 基礎（偏差値40-45）- 小学4年生レベル
- レベル2: 標準（偏差値45-50）- 小学5年生レベル
- レベル3: 応用（偏差値50-55）- 中学受験頻出
- レベル4: 発展（偏差値55+）- 追手門学院最難関

**出題配分**:
- レベル1: 30%（3問）
- レベル2: 30%（3問）
- レベル3: 30%（3問）
- レベル4: 10%（1問）

#### 2.1.3 文脈付き問題提示
**仕様**:
- 55種類の文脈パターンを使用
- 漢字を自然な文章に埋め込み
- 「」で漢字部分を強調表示

**例**:
```
彼の「愛情」深い態度に感心した。
```

#### 2.1.4 選択肢生成・検証機能
**機能詳細**:
- 4択の選択肢を自動生成
- 正解＋ダミー3つ
- 重複チェックと自動修正
- レベル適応型ダミー選択

**検証ロジック**:
1. 重複チェック
2. 類似度チェック（同音異義語回避）
3. 難易度適合性チェック
4. 自動修正または代替選択肢生成

### 2.2 報酬システム

#### 2.2.1 ポイント計算
**基本ルール**:
```
基本ポイント: 15P（6問以上正解）
正解率ボーナス:
- 7-8問正解: +2P
- 9問正解: +3P
- 10問正解: +5P
```

**連続ボーナス**:
- 3日連続: +10P
- 5日連続: +20P（100円達成）
- 7日連続: +30P

#### 2.2.2 小遣い換算
**換算レート**: 100ポイント = 100円

**支払いタイミング**:
- 100ポイント到達時に即時通知
- 端数は次回に繰り越し

#### 2.2.3 実績システム
**実績種類**:
```javascript
{
  初回学習: "学習スタート！",
  初満点: "初めての満点！",
  3日継続: "3日間継続！",
  週間マスター: "7日連続学習",
  月間皆勤賞: "30日連続学習",
  初100円: "初めての100円！",
  貯金マスター: "合計1000円獲得"
}
```

### 2.3 進捗管理機能

#### 2.3.1 学習履歴記録
**記録項目**:
- 学習日時
- 問題内容（10問）
- 回答結果
- 獲得ポイント
- 所要時間

**データ保存**:
- ローカルストレージに保存
- JSON形式
- 最大1年分保持

#### 2.3.2 統計情報
**表示項目**:
- 総学習日数
- 平均正解率
- 累計獲得ポイント
- 累計獲得金額
- 現在の連続日数
- 最長連続記録

#### 2.3.3 可視化機能
**グラフ・チャート**:
- 30日間の学習カレンダー
- 日別ポイント獲得グラフ
- 正解率推移グラフ
- レベル別正解率

### 2.4 UI/UX機能

#### 2.4.1 レスポンシブデザイン
**ブレークポイント**:
- デスクトップ: 1200px以上
- タブレット: 768px-1199px
- スマートフォン: 767px以下

#### 2.4.2 アニメーション
**実装項目**:
- 正解時の星アニメーション
- 100円獲得時の紙吹雪エフェクト
- プログレスバーのスムーズな更新
- ボタンホバーエフェクト

#### 2.4.3 アクセシビリティ
**対応項目**:
- キーボードナビゲーション
- スクリーンリーダー対応
- 高コントラストモード
- 文字サイズ調整機能

### 2.5 保護者機能

#### 2.5.1 応援メッセージ
**機能**:
- テキストメッセージ送信
- 送信者名設定
- 既読管理

#### 2.5.2 学習レポート
**内容**:
- 週間サマリー
- 月間レポート
- 苦手分野分析

## 3. データベース設計

### 3.1 漢字マスターデータ
```javascript
KanjiMaster {
  id: number,
  word: string,
  reading: string,
  meaning: string,
  level: 1-4,
  grade: string,
  frequency: number,
  category: string[]
}
```

### 3.2 学習履歴データ
```javascript
StudyHistory {
  date: string,
  userId: string,
  problems: Problem[],
  results: Result[],
  totalPoints: number,
  timeSpent: number
}
```

### 3.3 ユーザーデータ
```javascript
UserData {
  userId: string,
  nickname: string,
  totalPoints: number,
  totalEarned: number,
  currentStreak: number,
  bestStreak: number,
  achievements: Achievement[],
  settings: UserSettings
}
```

## 4. 非機能要件

### 4.1 パフォーマンス要件
- ページ読み込み: 3秒以内
- 問題生成: 100ms以内
- UI応答: 50ms以内

### 4.2 セキュリティ要件
- HTTPS通信必須
- XSS対策実装
- CSRF対策実装
- データ暗号化

### 4.3 可用性要件
- オフライン動作対応
- データ自動バックアップ
- エラー自動リカバリ

### 4.4 保守性要件
- モジュール化設計
- 詳細なコメント記述
- エラーログ記録
- バージョン管理

## 5. 画面設計

### 5.1 画面一覧
1. **ホーム画面**: 学習開始ボタン、今日の進捗
2. **問題画面**: 問題表示、選択肢、送信ボタン
3. **結果画面**: 正解/不正解、解説、次へボタン
4. **進捗画面**: ポイント、グラフ、実績
5. **設定画面**: 音量、通知、プロフィール

### 5.2 画面遷移
```
ホーム → 問題(1-10) → 日次結果 → 報酬獲得 → ホーム
         ↓
      設定/進捗
```

## 6. API設計

### 6.1 内部API
```javascript
// 問題生成
generateDailyProblems(date: Date): Problem[]

// ポイント計算
calculatePoints(correct: number, total: number): Points

// 履歴保存
saveHistory(results: Results): boolean

// 統計取得
getStatistics(period: string): Statistics
```

### 6.2 外部連携（将来拡張）
- 学習管理システム（LMS）連携
- 決済システム連携
- SNS共有機能

## 7. テスト要件

### 7.1 単体テスト
- 関数単位のテスト
- カバレッジ80%以上
- Jest使用

### 7.2 統合テスト
- 画面遷移テスト
- データ永続化テスト
- エラーハンドリングテスト

### 7.3 ユーザビリティテスト
- 対象年齢での操作確認
- 5分以内での学習完了
- 直感的な操作性

## 8. 運用要件

### 8.1 リリース計画
- Phase 1: 基本機能（問題・報酬）
- Phase 2: 統計・グラフ機能
- Phase 3: 保護者機能
- Phase 4: 外部連携

### 8.2 サポート体制
- FAQ準備
- 問い合わせフォーム
- 定期メンテナンス（月1回）

### 8.3 改善サイクル
- 利用ログ分析
- ユーザーフィードバック収集
- 四半期ごとの機能改善

## 9. 制約事項

### 9.1 技術的制約
- ブラウザローカルストレージ使用
- サーバーレス構成
- 静的ホスティング

### 9.2 法的制約
- 個人情報保護法準拠
- 児童オンラインプライバシー保護法準拠
- 著作権配慮（漢字データ）

## 10. 用語定義

| 用語 | 定義 |
|------|------|
| 漢字マスター | 本システムの名称 |
| ポイント | 学習成果を数値化した単位 |
| 連続日数 | 休まず学習した日数 |
| 実績 | 特定条件達成時の称号 |
| レベル | 問題の難易度区分 |

## 11. 変更履歴

| 版数 | 日付 | 変更内容 | 作成者 |
|------|------|----------|--------|
| 1.0 | 2024-01-15 | 初版作成 | システム |

---

本要件定義書は、追手門学院中学入試対策漢字学習システムの開発における全ての要件を網羅しています。
開発者は本書に基づいて実装を行い、不明点がある場合は随時確認を行ってください。