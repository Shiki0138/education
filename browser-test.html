<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒè©³ç´°ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f0f0f0; }
        .test-section { margin: 20px 0; padding: 15px; background: white; border-radius: 8px; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        .info { color: blue; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .test-btn { background: #4CAF50; color: white; }
        .kanji-btn { background: #2196F3; color: white; }
    </style>
</head>
<body>
    <h1>ğŸ” ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒãƒ»JavaScriptå®Ÿè¡Œè©³ç´°ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <h2>ğŸ“Š åŸºæœ¬ç’°å¢ƒæƒ…å ±</h2>
        <div id="basicInfo"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸš€ JavaScriptå®Ÿè¡Œãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="testJSExecution()">JavaScriptå®Ÿè¡Œãƒ†ã‚¹ãƒˆ</button>
        <div id="jsTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“ æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ</h2>
        <button class="kanji-btn" onclick="testKanjiButton()">æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³å‹•ä½œãƒ†ã‚¹ãƒˆ</button>
        <button class="kanji-btn" onclick="startKanji()">å®Ÿéš›ã®æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³</button>
        <div id="kanjiTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒãƒªã‚·ãƒ¼ãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="testSecurityPolicy()">CSPãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ</button>
        <div id="securityTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“± ãƒ‡ãƒã‚¤ã‚¹ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="testDeviceInfo()">ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ãƒ†ã‚¹ãƒˆ</button>
        <div id="deviceTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ”— DOMãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="testDOMEvents()">DOMãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ</button>
        <div id="domTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“‹ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°</h2>
        <div id="consoleLog"></div>
    </div>

    <script>
        // ãƒ­ã‚°åé›†ã‚·ã‚¹ãƒ†ãƒ 
        let testLogs = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            testLogs.push(`[${timestamp}] ${type.toUpperCase()}: ${message}`);
            console.log(`[ãƒ†ã‚¹ãƒˆ] ${message}`);
            updateConsoleDisplay();
        }
        
        function updateConsoleDisplay() {
            const consoleDiv = document.getElementById('consoleLog');
            consoleDiv.innerHTML = '<pre>' + testLogs.slice(-10).join('\n') + '</pre>';
        }
        
        // åŸºæœ¬ç’°å¢ƒæƒ…å ±è¡¨ç¤º
        function displayBasicInfo() {
            const info = `
                <strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:</strong> ${navigator.userAgent}<br>
                <strong>ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ :</strong> ${navigator.platform}<br>
                <strong>ãƒ–ãƒ©ã‚¦ã‚¶è¨€èª:</strong> ${navigator.language}<br>
                <strong>ç”»é¢è§£åƒåº¦:</strong> ${screen.width}x${screen.height}<br>
                <strong>ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã‚µã‚¤ã‚º:</strong> ${window.innerWidth}x${window.innerHeight}<br>
                <strong>ãƒ‡ãƒã‚¤ã‚¹ãƒ”ã‚¯ã‚»ãƒ«æ¯”:</strong> ${window.devicePixelRatio}<br>
                <strong>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³çŠ¶æ…‹:</strong> ${navigator.onLine ? 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³' : 'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³'}<br>
                <strong>Cookieæœ‰åŠ¹:</strong> ${navigator.cookieEnabled ? 'ã¯ã„' : 'ã„ã„ãˆ'}<br>
                <strong>JavaScriptæœ‰åŠ¹:</strong> <span class="success">ã¯ã„</span><br>
                <strong>ç¾åœ¨æ™‚åˆ»:</strong> ${new Date().toString()}
            `;
            document.getElementById('basicInfo').innerHTML = info;
            log('åŸºæœ¬ç’°å¢ƒæƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ');
        }
        
        // JavaScriptå®Ÿè¡Œãƒ†ã‚¹ãƒˆ
        function testJSExecution() {
            let result = '';
            let errors = [];
            
            try {
                // åŸºæœ¬çš„ãªæ¼”ç®—ãƒ†ã‚¹ãƒˆ
                const mathTest = 2 + 2;
                result += `<div class="success">âœ… åŸºæœ¬æ¼”ç®—: ${mathTest} (æ­£å¸¸)</div>`;
                
                // DOMæ“ä½œãƒ†ã‚¹ãƒˆ
                const testDiv = document.createElement('div');
                testDiv.textContent = 'ãƒ†ã‚¹ãƒˆ';
                result += `<div class="success">âœ… DOMæ“ä½œ: ${testDiv.textContent} (æ­£å¸¸)</div>`;
                
                // é…åˆ—æ“ä½œãƒ†ã‚¹ãƒˆ
                const testArray = [1, 2, 3].map(x => x * 2);
                result += `<div class="success">âœ… é…åˆ—æ“ä½œ: [${testArray.join(', ')}] (æ­£å¸¸)</div>`;
                
                // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ãƒ†ã‚¹ãƒˆ
                const testBtn = document.createElement('button');
                testBtn.addEventListener('click', () => {});
                result += `<div class="success">âœ… ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼: æ­£å¸¸</div>`;
                
                log('JavaScriptå®Ÿè¡Œãƒ†ã‚¹ãƒˆå®Œäº†: å…¨ã¦æ­£å¸¸');
                
            } catch (error) {
                errors.push(error.message);
                result += `<div class="error">âŒ JavaScriptå®Ÿè¡Œã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                log(`JavaScriptå®Ÿè¡Œã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
            
            document.getElementById('jsTestResult').innerHTML = result;
        }
        
        // æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ
        function testKanjiButton() {
            let result = '';
            
            try {
                // startKanjié–¢æ•°ã®å­˜åœ¨ç¢ºèª
                if (typeof startKanji === 'function') {
                    result += `<div class="success">âœ… startKanjié–¢æ•°: å®šç¾©æ¸ˆã¿</div>`;
                    log('startKanjié–¢æ•°ãŒæ­£ã—ãå®šç¾©ã•ã‚Œã¦ã„ã¾ã™');
                    
                    // å®Ÿéš›ã«é–¢æ•°å®Ÿè¡Œãƒ†ã‚¹ãƒˆï¼ˆå®‰å…¨ã«ï¼‰
                    try {
                        // å®Ÿéš›ã«ã¯å®Ÿè¡Œã›ãšã€é–¢æ•°ã®æ–‡å­—åˆ—è¡¨ç¾ã‚’ç¢ºèª
                        const funcStr = startKanji.toString();
                        result += `<div class="info">ğŸ“‹ é–¢æ•°å†…å®¹ç¢ºèª: ${funcStr.length}æ–‡å­—</div>`;
                        log(`startKanjié–¢æ•°ã®é•·ã•: ${funcStr.length}æ–‡å­—`);
                    } catch (e) {
                        result += `<div class="warning">âš ï¸ é–¢æ•°å†…å®¹å–å¾—ã‚¨ãƒ©ãƒ¼: ${e.message}</div>`;
                        log(`é–¢æ•°å†…å®¹å–å¾—ã‚¨ãƒ©ãƒ¼: ${e.message}`, 'warning');
                    }
                } else {
                    result += `<div class="error">âŒ startKanjié–¢æ•°: æœªå®šç¾©</div>`;
                    log('startKanjié–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
                }
                
                // ãƒœã‚¿ãƒ³è¦ç´ ã®ç¢ºèª
                const kanjiButtons = document.querySelectorAll('[onclick*="startKanji"]');
                result += `<div class="info">ğŸ“Š æ¼¢å­—ãƒœã‚¿ãƒ³æ•°: ${kanjiButtons.length}å€‹</div>`;
                log(`æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³ãŒ${kanjiButtons.length}å€‹è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`);
                
                // onclickå±æ€§ã®ç¢ºèª
                kanjiButtons.forEach((btn, index) => {
                    const onclickValue = btn.getAttribute('onclick');
                    result += `<div class="info">ğŸ”˜ ãƒœã‚¿ãƒ³${index + 1} onclick: ${onclickValue}</div>`;
                    log(`ãƒœã‚¿ãƒ³${index + 1}ã®onclickå±æ€§: ${onclickValue}`);
                });
                
            } catch (error) {
                result += `<div class="error">âŒ æ¼¢å­—ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                log(`æ¼¢å­—ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
            
            document.getElementById('kanjiTestResult').innerHTML = result;
        }
        
        // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ãƒ†ã‚¹ãƒˆ
        function testSecurityPolicy() {
            let result = '';
            
            try {
                // CSPã®ç¢ºèª
                const metaTags = document.querySelectorAll('meta[http-equiv="Content-Security-Policy"]');
                if (metaTags.length > 0) {
                    result += `<div class="warning">âš ï¸ CSPæ¤œå‡º: ${metaTags.length}å€‹ã®CSPãƒ¡ã‚¿ã‚¿ã‚°</div>`;
                    metaTags.forEach(tag => {
                        result += `<div class="info">ğŸ“‹ CSPå†…å®¹: ${tag.content}</div>`;
                    });
                } else {
                    result += `<div class="success">âœ… CSP: ãƒ¡ã‚¿ã‚¿ã‚°ãªã—</div>`;
                }
                
                // eval()ãƒ†ã‚¹ãƒˆ
                try {
                    eval('1+1');
                    result += `<div class="success">âœ… eval()å®Ÿè¡Œ: è¨±å¯</div>`;
                } catch (e) {
                    result += `<div class="error">âŒ eval()å®Ÿè¡Œ: åˆ¶é™ - ${e.message}</div>`;
                }
                
                // inline scriptãƒ†ã‚¹ãƒˆ
                result += `<div class="success">âœ… ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: å®Ÿè¡Œä¸­</div>`;
                
                log('ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                result += `<div class="error">âŒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                log(`ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
            
            document.getElementById('securityTestResult').innerHTML = result;
        }
        
        // ãƒ‡ãƒã‚¤ã‚¹ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆ
        function testDeviceInfo() {
            let result = '';
            
            // ãƒ–ãƒ©ã‚¦ã‚¶ç¨®é¡ã®åˆ¤å®š
            let browser = 'Unknown';
            if (navigator.userAgent.includes('Chrome')) browser = 'Chrome';
            else if (navigator.userAgent.includes('Firefox')) browser = 'Firefox';
            else if (navigator.userAgent.includes('Safari')) browser = 'Safari';
            else if (navigator.userAgent.includes('Edge')) browser = 'Edge';
            
            result += `<div class="info">ğŸŒ ãƒ–ãƒ©ã‚¦ã‚¶: ${browser}</div>`;
            
            // ãƒ‡ãƒã‚¤ã‚¹ç¨®é¡ã®åˆ¤å®š
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            result += `<div class="info">ğŸ“± ãƒ‡ãƒã‚¤ã‚¹: ${isMobile ? 'ãƒ¢ãƒã‚¤ãƒ«' : 'ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—'}</div>`;
            
            // ã‚¿ãƒƒãƒã‚µãƒãƒ¼ãƒˆ
            const hasTouch = 'ontouchstart' in window;
            result += `<div class="info">ğŸ‘† ã‚¿ãƒƒãƒã‚µãƒãƒ¼ãƒˆ: ${hasTouch ? 'ã‚ã‚Š' : 'ãªã—'}</div>`;
            
            // localStorage
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                result += `<div class="success">âœ… localStorage: åˆ©ç”¨å¯èƒ½</div>`;
            } catch (e) {
                result += `<div class="error">âŒ localStorage: åˆ©ç”¨ä¸å¯</div>`;
            }
            
            log(`ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†: ${browser}, ${isMobile ? 'ãƒ¢ãƒã‚¤ãƒ«' : 'ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—'}`);
            
            document.getElementById('deviceTestResult').innerHTML = result;
        }
        
        // DOMãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
        function testDOMEvents() {
            let result = '';
            
            try {
                // DOM ReadyçŠ¶æ…‹
                result += `<div class="success">âœ… DOMçŠ¶æ…‹: ${document.readyState}</div>`;
                
                // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ ãƒ†ã‚¹ãƒˆ
                const testBtn = document.createElement('button');
                let eventFired = false;
                testBtn.addEventListener('click', () => {
                    eventFired = true;
                });
                
                // äººå·¥çš„ã«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
                testBtn.click();
                result += `<div class="${eventFired ? 'success' : 'error'}">
                    ${eventFired ? 'âœ…' : 'âŒ'} ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«: ${eventFired ? 'æ­£å¸¸' : 'ç•°å¸¸'}
                </div>`;
                
                // querySelector ãƒ†ã‚¹ãƒˆ
                const menuBtns = document.querySelectorAll('.menu-btn');
                result += `<div class="info">ğŸ” .menu-btnè¦ç´ : ${menuBtns.length}å€‹</div>`;
                
                log(`DOMãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚¹ãƒˆå®Œäº†: ${menuBtns.length}å€‹ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³æ¤œå‡º`);
                
            } catch (error) {
                result += `<div class="error">âŒ DOMãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                log(`DOMãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
            
            document.getElementById('domTestResult').innerHTML = result;
        }
        
        // startKanjié–¢æ•°ã®ãƒ¢ãƒƒã‚¯ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã®é–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰
        function startKanji() {
            log('startKanji()ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã—ãŸ');
            alert('startKanji()é–¢æ•°ãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã¾ã—ãŸï¼\n\næ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³ã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚');
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†');
            displayBasicInfo();
            
            // 3ç§’å¾Œã«è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            setTimeout(() => {
                log('è‡ªå‹•ãƒ†ã‚¹ãƒˆé–‹å§‹');
                testJSExecution();
                testDeviceInfo();
                testDOMEvents();
            }, 3000);
        });
        
        // ã‚¨ãƒ©ãƒ¼ã‚­ãƒ£ãƒƒãƒ
        window.addEventListener('error', function(e) {
            log(`ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼: ${e.error.message}`, 'error');
        });
        
        // æœªå‡¦ç†ã®Promiseæ‹’å¦ã‚’ã‚­ãƒ£ãƒƒãƒ
        window.addEventListener('unhandledrejection', function(e) {
            log(`æœªå‡¦ç†ã®Promiseæ‹’å¦: ${e.reason}`, 'error');
        });
        
        log('ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆåˆæœŸåŒ–å®Œäº†');
    </script>
</body>
</html>