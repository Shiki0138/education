<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>合格への道 - 国語学習アプリ（シンプル版）</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #1976d2, #1565c0);
            color: white;
            border-radius: 15px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .menu-btn {
            background: linear-gradient(135deg, #bbdefb, #e3f2fd);
            border: 2px solid #90caf9;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 16px;
            color: #1565c0;
        }

        .menu-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(25, 118, 210, 0.2);
        }

        .menu-icon {
            font-size: 36px;
            margin-bottom: 10px;
            display: block;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .practice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e3f2fd;
        }

        .back-btn {
            background: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 18px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option-btn {
            background: #e3f2fd;
            border: 2px solid #90caf9;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .option-btn:hover {
            background: #bbdefb;
        }

        .option-btn.correct {
            background: #c8e6c9;
            border-color: #4caf50;
            color: #2e7d32;
        }

        .option-btn.incorrect {
            background: #ffcdd2;
            border-color: #f44336;
            color: #c62828;
        }

        .result-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            z-index: 10000;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .result-popup.show {
            display: block;
            animation: popupShow 0.3s ease-out;
        }

        @keyframes popupShow {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .result-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .debug-info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 10000;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- メイン画面 -->
        <div id="mainScreen" class="screen active">
            <div class="header">
                <h1>📚 合格への道</h1>
                <p>中学受験国語学習アプリ</p>
                <div>Lv.<span id="userLevel">1</span> | <span id="streakDays">0</span>日連続</div>
            </div>

            <div class="menu-grid">
                <button class="menu-btn" onclick="startKanji()">
                    <span class="menu-icon">📝</span>
                    <div><strong>漢字練習</strong></div>
                    <div>基本漢字をマスター</div>
                </button>
                <button class="menu-btn" onclick="startReading()">
                    <span class="menu-icon">📖</span>
                    <div><strong>読解問題</strong></div>
                    <div>文章理解力を鍛える</div>
                </button>
                <button class="menu-btn" onclick="startVocab()">
                    <span class="menu-icon">💬</span>
                    <div><strong>語彙力強化</strong></div>
                    <div>ことわざ・慣用句</div>
                </button>
                <button class="menu-btn" onclick="startAI()">
                    <span class="menu-icon">🤖</span>
                    <div><strong>AI問題生成</strong></div>
                    <div>個人最適化問題</div>
                </button>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <div>📊 今日の進捗: <span id="todayProgress">0/30分</span></div>
                <div>⭐ ポイント: <span id="totalPoints">0</span>pt</div>
                <div>🎯 正答率: <span id="accuracy">0</span>%</div>
            </div>
        </div>

        <!-- 漢字練習画面 -->
        <div id="kanjiScreen" class="screen">
            <div class="practice-header">
                <button class="back-btn" onclick="goHome()">← 戻る</button>
                <h2>📝 漢字練習</h2>
                <div>スコア: <span id="score">0</span>点</div>
            </div>

            <div class="question-card">
                <div>問題 <span id="questionNum">1</span> / 5</div>
                <div class="question-text" id="questionText">
                    読み込み中...
                </div>
                <div class="options" id="optionsContainer">
                    <!-- 選択肢がここに表示される -->
                </div>
            </div>

            <div style="text-align: center;">
                <button onclick="showHint()" style="background: #ffc107; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer;">
                    💡 ヒント
                </button>
                <div id="hintText" style="margin-top: 10px; padding: 10px; background: #fff3cd; border-radius: 10px; display: none;"></div>
            </div>
        </div>

        <!-- 結果ポップアップ -->
        <div id="resultPopup" class="result-popup">
            <div class="result-icon" id="resultIcon">🎉</div>
            <div id="resultMessage"></div>
            <button onclick="nextQuestion()" style="margin-top: 20px; padding: 10px 20px; background: #1976d2; color: white; border: none; border-radius: 10px; cursor: pointer;">
                次の問題
            </button>
        </div>
    </div>

    <!-- デバッグ情報 -->
    <div class="debug-info" id="debugInfo">
        アプリ状態: <span id="appStatus">読み込み中...</span>
    </div>

    <script>
        // シンプルで確実に動作するコード
        console.log('🚀 シンプル版アプリ開始');

        // 基本データ
        let currentQuestion = 0;
        let score = 0;
        let userData = {
            level: 1,
            points: 0,
            streak: 0,
            accuracy: 0,
            questionsToday: 0,
            correctToday: 0
        };

        // 漢字問題データ（最小限）
        const kanjiProblems = [
            {
                question: "次の漢字の読み方を選びなさい：【学校】",
                options: ["がっこう", "がくこう", "がくしょう", "がっしょう"],
                correct: 0,
                hint: "みんなが勉強する場所です",
                explanation: "学校（がっこう）= 勉強する場所"
            },
            {
                question: "次の漢字の読み方を選びなさい：【友達】",
                options: ["ゆうたつ", "ともだち", "ゆうだち", "ともたつ"],
                correct: 1,
                hint: "親しい仲間のことです",
                explanation: "友達（ともだち）= 親しい仲間"
            },
            {
                question: "次の漢字の読み方を選びなさい：【先生】",
                options: ["せんせい", "せんじょう", "さきうまれ", "せんしょう"],
                correct: 0,
                hint: "教えてくれる人です",
                explanation: "先生（せんせい）= 教えてくれる人"
            },
            {
                question: "次の漢字の読み方を選びなさい：【自然】",
                options: ["しぜん", "じねん", "しねん", "じぜん"],
                correct: 0,
                hint: "人工でないもの",
                explanation: "自然（しぜん）= 人工でないもの"
            },
            {
                question: "次の漢字の読み方を選びなさい：【運動】",
                options: ["うんどう", "うんてん", "うんそう", "うんゆう"],
                correct: 0,
                hint: "体を動かすこと",
                explanation: "運動（うんどう）= 体を動かすこと"
            }
        ];

        // 画面切り替え関数
        function showScreen(screenId) {
            console.log(`🔄 画面切り替え: ${screenId}`);
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            const screen = document.getElementById(screenId);
            if (screen) {
                screen.classList.add('active');
                console.log(`✅ ${screenId} 表示完了`);
            } else {
                console.error(`❌ ${screenId} が見つかりません`);
            }
        }

        // 漢字練習開始
        function startKanji() {
            console.log('📝 漢字練習開始（シンプル版）');
            currentQuestion = 0;
            score = 0;
            showScreen('kanjiScreen');
            showKanjiQuestion();
        }

        // 読解問題開始
        function startReading() {
            console.log('📖 読解問題開始');
            alert('読解問題機能です。\n現在、漢字練習から始めることをお勧めします。');
            startKanji();
        }

        // 語彙力強化開始
        function startVocab() {
            console.log('💬 語彙力強化開始');
            alert('語彙力強化機能です。\nことわざや慣用句を学習できます。\n現在準備中のため、漢字練習から始めてください。');
            startKanji();
        }

        // AI問題生成開始
        function startAI() {
            console.log('🤖 AI問題生成開始');
            alert('AI問題生成機能です。\nあなたの弱点を分析して最適な問題を出題します。\n現在は漢字練習をお楽しみください。');
            startKanji();
        }

        // ホーム画面に戻る
        function goHome() {
            console.log('🏠 ホーム画面に戻る');
            showScreen('mainScreen');
        }

        // 漢字問題表示
        function showKanjiQuestion() {
            if (currentQuestion >= kanjiProblems.length) {
                showResult();
                return;
            }

            const problem = kanjiProblems[currentQuestion];
            
            document.getElementById('questionNum').textContent = currentQuestion + 1;
            document.getElementById('questionText').textContent = problem.question;
            
            const optionsHTML = problem.options.map((option, index) => 
                `<button class="option-btn" onclick="checkAnswer(${index})">${index + 1}. ${option}</button>`
            ).join('');
            
            document.getElementById('optionsContainer').innerHTML = optionsHTML;
            document.getElementById('hintText').style.display = 'none';
            
            console.log(`📝 問題${currentQuestion + 1}表示: ${problem.question}`);
        }

        // 答え合わせ
        function checkAnswer(selected) {
            const problem = kanjiProblems[currentQuestion];
            const buttons = document.querySelectorAll('.option-btn');
            const isCorrect = selected === problem.correct;
            
            console.log(`🔍 答え合わせ: 選択=${selected}, 正解=${problem.correct}, 結果=${isCorrect ? '正解' : '不正解'}`);
            
            if (isCorrect) {
                buttons[selected].classList.add('correct');
                score += 10;
                userData.correctToday++;
                showResultPopup(true, problem.explanation);
            } else {
                buttons[selected].classList.add('incorrect');
                buttons[problem.correct].classList.add('correct');
                showResultPopup(false, problem.explanation);
            }
            
            userData.questionsToday++;
            updateUI();
            
            setTimeout(() => {
                currentQuestion++;
                closeResultPopup();
                showKanjiQuestion();
            }, 2500);
        }

        // 結果ポップアップ表示
        function showResultPopup(isCorrect, explanation) {
            const popup = document.getElementById('resultPopup');
            const icon = document.getElementById('resultIcon');
            const message = document.getElementById('resultMessage');
            
            if (isCorrect) {
                icon.textContent = '🎉';
                message.innerHTML = `<strong>正解！</strong><br>${explanation}`;
            } else {
                icon.textContent = '😅';
                message.innerHTML = `<strong>不正解</strong><br>${explanation}`;
            }
            
            popup.classList.add('show');
        }

        // 結果ポップアップを閉じる
        function closeResultPopup() {
            document.getElementById('resultPopup').classList.remove('show');
        }

        // 次の問題
        function nextQuestion() {
            closeResultPopup();
            currentQuestion++;
            showKanjiQuestion();
        }

        // ヒント表示
        function showHint() {
            const problem = kanjiProblems[currentQuestion];
            const hintEl = document.getElementById('hintText');
            hintEl.textContent = problem.hint;
            hintEl.style.display = 'block';
        }

        // UI更新
        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('totalPoints').textContent = userData.points;
            document.getElementById('userLevel').textContent = userData.level;
            document.getElementById('streakDays').textContent = userData.streak;
            
            const accuracy = userData.questionsToday > 0 
                ? Math.round((userData.correctToday / userData.questionsToday) * 100) 
                : 0;
            document.getElementById('accuracy').textContent = accuracy;
            
            document.getElementById('todayProgress').textContent = `${Math.min(userData.questionsToday * 3, 30)}/30分`;
        }

        // 結果表示
        function showResult() {
            const accuracy = userData.questionsToday > 0 
                ? Math.round((userData.correctToday / userData.questionsToday) * 100) 
                : 0;
            
            alert(`🏆 漢字練習完了！
                    
スコア: ${score}点
正答率: ${accuracy}%
                    
お疲れさまでした！`);
            
            goHome();
        }

        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('✅ シンプル版アプリ読み込み完了');
            document.getElementById('appStatus').textContent = '正常動作中';
            updateUI();
            
            // 5秒後に動作確認
            setTimeout(() => {
                console.log('🔍 5秒後動作確認');
                const kanjiBtn = document.querySelector('.menu-btn');
                if (kanjiBtn) {
                    console.log('✅ 漢字ボタン要素存在確認');
                } else {
                    console.error('❌ 漢字ボタン要素が見つかりません');
                }
            }, 5000);
        });

        // デバッグ用：強制的にボタンを有効化
        setTimeout(() => {
            const buttons = document.querySelectorAll('.menu-btn');
            buttons.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    console.log(`🔘 ボタン${index + 1}がクリックされました`);
                });
            });
            console.log('🔘 ボタンイベントリスナー追加完了');
        }, 2000);

    </script>
</body>
</html>