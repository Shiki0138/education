<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒãƒƒã‚°ãƒ†ã‚¹ãƒˆ - åˆæ ¼ã¸ã®é“</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
        .test-btn { background: #007bff; color: white; }
        .test-btn:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>ğŸ”§ ã‚¢ãƒ—ãƒªå‹•ä½œãƒ‡ãƒãƒƒã‚°ãƒ†ã‚¹ãƒˆ</h1>
    
    <div id="testResults"></div>
    
    <h2>ğŸ“Š æ‰‹å‹•ãƒ†ã‚¹ãƒˆ</h2>
    <button class="test-btn" onclick="testKanjiButton()">æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ</button>
    <button class="test-btn" onclick="testReadingButton()">èª­è§£å•é¡Œãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ</button>
    <button class="test-btn" onclick="testVocabularyButton()">èªå½™åŠ›ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ</button>
    <button class="test-btn" onclick="testAIButton()">AIå•é¡Œç”Ÿæˆãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ</button>
    
    <h2>ğŸ“ çµæœãƒ­ã‚°</h2>
    <div id="logOutput" style="background: #f8f9fa; padding: 15px; border-radius: 5px; height: 200px; overflow-y: auto;"></div>

    <!-- å¿…è¦ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èª­ã¿è¾¼ã¿ -->
    <script src="exam-data.js"></script>
    <script src="mega-kanji-database-1.js"></script>
    <script src="mega-kanji-database-2.js"></script>
    <script src="mega-kanji-database-3.js"></script>
    <script src="mega-kanji-database-4.js"></script>
    <script src="mega-kanji-database-5.js"></script>
    <script src="mega-database-final.js"></script>
    <script src="option-randomizer.js"></script>
    <script src="kanji-grade-data.js"></script>
    <script src="app.js"></script>
    <script src="enhanced-app.js"></script>
    <script src="simple-effects.js"></script>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('logOutput');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logDiv.textContent += logEntry;
            logDiv.scrollTop = logDiv.scrollHeight;
            
            if (type === 'error') {
                console.error(message);
            } else {
                console.log(message);
            }
        }

        function addTestResult(name, success, details = '') {
            const resultsDiv = document.getElementById('testResults');
            const result = document.createElement('div');
            result.className = `test-result ${success ? 'success' : 'error'}`;
            result.innerHTML = `
                <strong>${success ? 'âœ…' : 'âŒ'} ${name}</strong><br>
                ${details}
            `;
            resultsDiv.appendChild(result);
        }

        // è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        window.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ ãƒ‡ãƒãƒƒã‚°ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            setTimeout(() => {
                runAutomaticTests();
            }, 1000);
        });

        function runAutomaticTests() {
            // 1. åŸºæœ¬å¤‰æ•°ã®å­˜åœ¨ç¢ºèª
            const hasUserData = typeof userData !== 'undefined';
            addTestResult('ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿', hasUserData, hasUserData ? `ãƒ¬ãƒ™ãƒ«: ${userData.level}` : 'userDataæœªå®šç¾©');
            log(`ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ç¢ºèª: ${hasUserData ? 'æ­£å¸¸' : 'ã‚¨ãƒ©ãƒ¼'}`);

            // 2. æ¼¢å­—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª
            const hasKanjiQuestions = typeof kanjiQuestions !== 'undefined';
            const kanjiCount = hasKanjiQuestions ? kanjiQuestions.length : 0;
            addTestResult('æ¼¢å­—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹', kanjiCount > 100, `å•é¡Œæ•°: ${kanjiCount}å•`);
            log(`æ¼¢å­—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: ${kanjiCount}å•`);

            // 3. é–¢æ•°ã®å­˜åœ¨ç¢ºèª
            const functions = [
                'startKanjiPractice', 'startReading', 'startVocabulary', 'startAIPractice',
                'showAnswerFeedback', 'updateUI', 'saveUserData', 'loadUserData'
            ];
            
            functions.forEach(funcName => {
                const exists = typeof window[funcName] === 'function';
                addTestResult(`é–¢æ•°: ${funcName}`, exists, exists ? 'å®šç¾©æ¸ˆã¿' : 'æœªå®šç¾©');
                log(`${funcName}: ${exists ? 'âœ…' : 'âŒ'}`);
            });

            // 4. DOMè¦ç´ ã®å­˜åœ¨ç¢ºèª
            const elements = ['app', 'mainScreen', 'kanjiScreen', 'readingScreen'];
            elements.forEach(id => {
                const exists = document.getElementById(id) !== null;
                addTestResult(`DOMè¦ç´ : ${id}`, exists, exists ? 'å­˜åœ¨' : 'æœªå­˜åœ¨');
                log(`${id}: ${exists ? 'âœ…' : 'âŒ'}`);
            });

            // 5. CSSèª­ã¿è¾¼ã¿ç¢ºèª
            const cssLoaded = document.querySelector('link[href*="refined-ui.css"]') !== null;
            addTestResult('CSSãƒ•ã‚¡ã‚¤ãƒ«', cssLoaded, cssLoaded ? 'refined-ui.cssèª­ã¿è¾¼ã¿æ¸ˆã¿' : 'CSSæœªèª­ã¿è¾¼ã¿');
            log(`CSSèª­ã¿è¾¼ã¿: ${cssLoaded ? 'âœ…' : 'âŒ'}`);

            log('ğŸ è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Œäº†');
        }

        // æ‰‹å‹•ãƒ†ã‚¹ãƒˆé–¢æ•°
        function testKanjiButton() {
            log('ğŸ§ª æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆé–‹å§‹');
            try {
                if (typeof startKanjiPractice === 'function') {
                    startKanjiPractice();
                    log('âœ… æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³æ­£å¸¸å‹•ä½œ');
                    addTestResult('æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³', true, 'æ­£å¸¸ã«å‹•ä½œ');
                } else {
                    log('âŒ startKanjiPracticeé–¢æ•°ãŒæœªå®šç¾©');
                    addTestResult('æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³', false, 'startKanjiPracticeé–¢æ•°æœªå®šç¾©');
                }
            } catch (error) {
                log(`âŒ æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                addTestResult('æ¼¢å­—ç·´ç¿’ãƒœã‚¿ãƒ³', false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }

        function testReadingButton() {
            log('ğŸ§ª èª­è§£å•é¡Œãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆé–‹å§‹');
            try {
                if (typeof startReading === 'function') {
                    startReading();
                    log('âœ… èª­è§£å•é¡Œãƒœã‚¿ãƒ³æ­£å¸¸å‹•ä½œ');
                    addTestResult('èª­è§£å•é¡Œãƒœã‚¿ãƒ³', true, 'æ­£å¸¸ã«å‹•ä½œ');
                } else {
                    log('âŒ startReadingé–¢æ•°ãŒæœªå®šç¾©');
                    addTestResult('èª­è§£å•é¡Œãƒœã‚¿ãƒ³', false, 'startReadingé–¢æ•°æœªå®šç¾©');
                }
            } catch (error) {
                log(`âŒ èª­è§£å•é¡Œãƒœã‚¿ãƒ³ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                addTestResult('èª­è§£å•é¡Œãƒœã‚¿ãƒ³', false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }

        function testVocabularyButton() {
            log('ğŸ§ª èªå½™åŠ›ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆé–‹å§‹');
            try {
                if (typeof startVocabulary === 'function') {
                    startVocabulary();
                    log('âœ… èªå½™åŠ›ãƒœã‚¿ãƒ³æ­£å¸¸å‹•ä½œ');
                    addTestResult('èªå½™åŠ›ãƒœã‚¿ãƒ³', true, 'æ­£å¸¸ã«å‹•ä½œ');
                } else {
                    log('âŒ startVocabularyé–¢æ•°ãŒæœªå®šç¾©');
                    addTestResult('èªå½™åŠ›ãƒœã‚¿ãƒ³', false, 'startVocabularyé–¢æ•°æœªå®šç¾©');
                }
            } catch (error) {
                log(`âŒ èªå½™åŠ›ãƒœã‚¿ãƒ³ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                addTestResult('èªå½™åŠ›ãƒœã‚¿ãƒ³', false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }

        function testAIButton() {
            log('ğŸ§ª AIå•é¡Œç”Ÿæˆãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆé–‹å§‹');
            try {
                if (typeof startAIPractice === 'function') {
                    startAIPractice();
                    log('âœ… AIå•é¡Œç”Ÿæˆãƒœã‚¿ãƒ³æ­£å¸¸å‹•ä½œ');
                    addTestResult('AIå•é¡Œç”Ÿæˆãƒœã‚¿ãƒ³', true, 'æ­£å¸¸ã«å‹•ä½œ');
                } else {
                    log('âŒ startAIPracticeé–¢æ•°ãŒæœªå®šç¾©');
                    addTestResult('AIå•é¡Œç”Ÿæˆãƒœã‚¿ãƒ³', false, 'startAIPracticeé–¢æ•°æœªå®šç¾©');
                }
            } catch (error) {
                log(`âŒ AIå•é¡Œç”Ÿæˆãƒœã‚¿ãƒ³ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                addTestResult('AIå•é¡Œç”Ÿæˆãƒœã‚¿ãƒ³', false, `ã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }
    </script>
</body>
</html>